<link href="../static/bower_components/datatables.net-bs/css/dataTables.bootstrap.min.css" rel="stylesheet">
<!--<div class="form-desc">DataTables is a plug-in for the jQuery Javascript library. It is-->
    <!--<a-->
            <!--href="https://www.datatables.net/" target="_blank">Learn More about-->
        <!--DataTables</a></div>-->

<style>
    .pane {
    display: inline-block;
    overflow-y: scroll;
    max-height:400px;
}
</style>

<div class="table-responsive"style="font-size:0.8em; line-height:10px;border-top-color:rgba(83,101,140,0.08) " >
    <table id="job_table" style=" width:auto" class="table table-striped table-lightfont  pane ">
        <thead>
        <tr>
            <th><b>Job Name</b></th>
            <th><b>Interval</b></th>
            <th><b>Status</b></th>
             <th><b>Job</b></th>
            <th><b>Action</b></th>

        </tr>
        </thead>

        <tbody>
        {% if backgroundSchedularList %}
        {%
        for scheduler in backgroundSchedularList %}
        <tr>
            <td >{{scheduler.job}}</td>
            <td>{{scheduler.interval}}</td>
            {%if scheduler.status=="Running..."%}
             <td><a class="btn btn-sm btn-primary">
                {%else%}
            <td><a class="btn btn-sm btn-danger">
                {% endif %}
                {{scheduler.status}}</a></td>

            <td>
                {%if scheduler.status=="Running..."%}
                <button class="mr-2 mb-2 btn btn-success cancelJob"  name ="{{scheduler.id}}" type="button" > Cancel
                </button>
                {%else%}
                <button class="mr-2 mb-2 btn btn-success startJob"  name ="{{scheduler.id}}" type="button" > Start
                </button>
                 {% endif %}
            </a></td>


            <td>
                <button class="mr-2 mb-2 btn btn-secondary" type="button">
                    <a href="#">
                        <i class="os-icon os-icon-ui-49"></i>
                    </a>

                    <a class="danger" href="#">
                        <i class="os-icon os-icon-ui-15"></i>
                    </a>
                </button>
            </td>

        </tr>
        {% endfor%}
        {% endif%}


        </tbody>
    </table>
</div>


<script src="../static/bower_components/editable-table/mindmup-editabletable.js"></script>
<script src="../static/bower_components/datatables.net/js/jquery.dataTables.min.js"></script>
<script src="../static/bower_components/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>

<script>

$("#job_table").on('click',".cancelJob",function() {
var jobId=$(this).attr('name');


  $.ajax({
		      url: '/settings/schedularsettings/cancel-job',
		      type: "POST",
		      beforeSend: function (){
		       $('.cancelJob').prop('disabled', true);
              },
            complete: function (){
               $('.cancelJob').prop('disabled', false);
             },
             data:{jobId:jobId},
		      success : function(content){
		     if(content=="true"){
              alert("Job cancelled successfully");
		      getJobsTable();
		     }else{
		     alert(content);
		     }

		       },

		      error: function(data, errorThrown)
		      {
		     alert("error");
		      }
		 });



})




$("#job_table").on('click',".startJob",function() {
var jobId=$(this).attr('name');

  $.ajax({
		        url: '/settings/schedularsettings/activate-job',
		        type: "POST",
		        data:{jobId:jobId},
		        beforeSend: function (){
		            $('.startJob').prop('disabled', true);
                },
                complete: function (){
                    $('.startJob').prop('disabled', false);
                },
		        success : function(content){
		            if(content=="true"){
                        alert("Job started successfully");
		                getJobsTable();
		            }else{
		                alert(content);
		            }
		       },
		      error: function(data, errorThrown)
		      {
		            alert("error");
		      }
		 });

})








$("#my_orders_table").on('click',".viewOrder",function() {
var orderId=$(this).attr('name');
var exchangeType=$(this).attr('exchangeType');
var  dateTime = Date.now().toString();


  <!--$.ajax({-->
		      <!--url: '/settings/ordersettings/view-order-detail',-->
		      <!--type: "POST",-->
		      <!--beforeSend: function (){-->
		       <!--$('.cancel').prop('disabled', true);-->
              <!--},-->
            <!--complete: function (){-->
             <!--$('.cancel').prop('disabled', false);-->
             <!--},-->
             <!--data:{orderId:orderId,dateTime:dateTime,exchangeType:exchangeType},-->
		      <!--success : function(content){-->

		       <!--},-->
		      <!--error: function(data, errorThrown)-->
		      <!--{-->
		     <!--alert("error")-->
		      <!--}-->
		 <!--});-->



})


	$("#my_orders_table").on('click'," .viewTrade",function() {
		var url =window.location.origin+"/"+window.location.pathname.split('/')[1];
		var ref= this.id;
		alert(url);

		window.open(url+"/ordersettings/view-order-detail?orderRef=ref", '_blank');
	})





</script>